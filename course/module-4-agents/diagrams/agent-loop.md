# Цикл работы агента (Agent Loop)

Агент работает итеративно, а не "сделал и все". Каждая итерация сужает разрыв между текущим состоянием кода и критериями приемки.

```mermaid
flowchart LR
    Plan["Plan\nАнализирует задачу,\nчитает файлы,\nсоставляет план"]
    Act["Act\nПишет код,\nсоздает файлы,\nвызывает команды"]
    Observe["Observe\nЗапускает тесты,\nлинтер, билд —\nчитает результат"]
    Decision{"Критерии\nвыполнены?"}
    Adjust["Adjust\nАнализирует ошибки,\nменяет подход"]
    Done["Готово\nКоммит + PR"]

    Plan --> Act --> Observe --> Decision
    Decision -->|"Нет — ошибки\nв тестах/линтере"| Adjust
    Adjust --> Plan
    Decision -->|"Да — все\nзеленое"| Done
```

**Ключевой момент:** агент не останавливается после первой попытки. Он итерирует до тех пор, пока:
- Все критерии приемки выполнены (тесты зеленые, линтер молчит), **или**
- Достигнут лимит итераций — тогда агент сообщает о блокере
