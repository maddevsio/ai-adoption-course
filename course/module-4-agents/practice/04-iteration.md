# Итерация — исправь найденные проблемы

На Шаге 3 вы провели ревью и нашли проблемы (например: нет тестов для 404, линтер ругается, отсутствуют type hints). Теперь нужно поставить агенту задачу исправить их.

### Как НЕ надо ставить задачу

**Плохой промпт:**

```
Исправь всё что не так
```

**Почему плохо:**
- Агент не знает, что именно не так
- Может исправить не те проблемы
- Или вообще ничего не сделать

### Как надо ставить задачу

**Хороший промпт:**

```
Проблемы:
1. Отсутствуют тесты для edge cases: [перечисление]
2. Линтер ругается: [CODE_SNIPPET]
3. Нарушение AGENTS.md: [перечисление]

После исправлений проверь, что они решили проблемы
```

### Когда остановиться

**Правило 3 итераций:** Если после 3 попыток проблема не решена — смените подход.

Агенты не всегда могут решить задачу с первого раза. Важно знать, когда остановиться:

**Стратегия:**
1. **Итерация 1:** Дайте агенту задачу, получите результат
2. **Итерация 2:** Если есть проблемы, дайте конкретную обратную связь
3. **Итерация 3:** Последняя попытка с ещё более детальными инструкциями

**Если после 3 итераций проблема не решена:**
- ❌ НЕ продолжайте бесконечно — агент может застрять в цикле
- ✅ Обновите контекст, дайте больше вводных, почитайте внешние источники (документация)
- ✅ Разбейте задачу на более мелкие подзадачи ИЛИ
- ✅ Измените требования

### Задание

1. Возьмите список проблем, найденных на Шаге 3 (ревью)
2. Напишите промпт с описанием проблемы и критериями исправления
3. Дайте агенту задачу исправить проблемы
4. После исправлений — проведите повторное ревью
5. Если всё ОК — закоммитьте изменения

### Проверка

Итерация завершена успешно, если:

- ✅ Все тесты проходят (pytest или npm test — зелёные)
- ✅ Линтер чистый (0 ошибок)
- ✅ Код соответствует AGENTS.md (type hints, async, conventions)
- ✅ Нет лишних файлов в git status
- ✅ Изменения закоммичены

### Время выполнения

15 минут
