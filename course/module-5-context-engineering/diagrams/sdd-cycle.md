# SDD-цикл (Spec-Driven Development)

Два вложенных цикла: внутренний (агент итерирует до зелёных тестов) и внешний (знания накапливаются между фичами).

**Внутренний цикл — агент реализует фичу:**

```mermaid
flowchart LR
    Spec["Спека"] --> Impl["Код"]
    Impl --> Test["Тесты<br>линтер"]
    Test -->|"Ошибки"| Fix["Исправление<br>дебаг"] --> Test
    Test -->|"Зелёное"| Review["Ревью"]
    Review -->|"Правки"| Spec
```

**Внешний цикл — знания накапливаются между фичами:**

```mermaid
flowchart LR
    Review["Ревью<br>принято"] --> Trace["Trace<br>решения, проблемы,<br>уроки"]
    Trace --> Reflect["Reflect<br>анализ traces"]
    Reflect --> Const["Constitution<br>новые правила"]
    Reflect --> Mem["Memories<br>паттерны ошибок"]
    Const --> Next["Следующая<br>спека"]
    Mem --> Next
```

**Почему это цикл, а не линейный процесс:**
- **Тесты + дебаг** — агент не сдаёт код с первой попытки, он итерирует до зелёных тестов
- **Trace** фиксирует решения, проблемы и найденные workarounds
- **Reflect-mode** анализирует traces и обновляет constitution (раз в N задач)
- **Memories** сохраняют паттерны ошибок — агент не повторяет одни и те же промахи
- С каждой итерацией агент работает точнее, потому что knowledge base растёт