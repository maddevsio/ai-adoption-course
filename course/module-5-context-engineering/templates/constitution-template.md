[← Оглавление](../../../README.md)

# Project Constitution

Живой документ проекта — компактный справочник активных правил для AI-агентов.

> **Для агентов:** Ты не имеешь памяти между сессиями. Каждая новая сессия начинается с нуля. Этот файл — твоя память. ОБЯЗАТЕЛЬНО прочитай его перед любой работой с кодом.

> **Бюджет:** ~400-500 строк. Каждая строка должна помогать агенту принять правильное решение. Если информация не влияет на решения — удали её.

---

## Project Overview

**Название:** [Название проекта]

**Назначение:** [1-2 предложения: что делает проект, для кого, какую проблему решает]

**Статус:** [MVP / Production / In Development / ...]

---

## Tech Stack

### Backend

- **Language:** [Go/Python/TypeScript/...] [версия] — [заметки]
- **Database:** [PostgreSQL/MySQL/MongoDB/...] [версия] — [схема, особенности]
- **API:** [REST/GraphQL/gRPC] — [фреймворк, библиотеки]
- **Cache:** [Redis/Memcached/...] [версия] — [для чего используется]
- **Testing:** [Go test/pytest/Jest/...] — [coverage target, подход]

### Frontend (если есть)

- **Framework:** [React/Vue/Svelte/...] [версия] — [особенности]
- **Build:** [Vite/Webpack/...]
- **Language:** [TypeScript/JavaScript] — [strict mode?]
- **State:** [Redux/Zustand/Pinia/...]
- **Styling:** [Tailwind/CSS Modules/...]
- **Testing:** [Vitest/Jest/...] — [coverage target]

### Infrastructure

- **Containers:** [Docker/Podman] — [Compose для локальной разработки?]
- **Orchestration:** [Kubernetes/... или пока нет]
- **CI/CD:** [GitHub Actions/GitLab CI/...] — [что автоматизировано]

---

## Architecture Decisions (ADR)

Принятые архитектурные решения, которые **нельзя менять без согласования**.

### ADR-001: [Название решения]

**Контекст:** [Какую проблему решали? Какие были ограничения?]

**Решение:** [Что выбрали и почему?]

**Причины:**
- [Причина 1: например, производительность]
- [Причина 2: например, упрощение]
- [Причина 3: например, совместимость]

**Альтернативы (рассматривали, но отвергли):**
- [Альтернатива 1 и почему отказались]
- [Альтернатива 2 и почему отказались]

**Последствия:** [Что это решение означает для кода? Какие ограничения вводит?]

**Статус:** [Принято / В работе / Устарело]

---

### ADR-002: [Следующее решение]

[Повторить структуру из ADR-001]

---

## Patterns (Обязательные паттерны)

Паттерны, которые **ОБЯЗАН** использовать каждый агент при написании кода.

### Pattern 1: [Название паттерна]

**Применимость:** [Когда использовать: например, "все API handlers", "работа с БД", "обработка ошибок"]

**Описание:** [Краткое описание паттерна]

**Пример кода:**

```[язык]
// Пример использования паттерна
// Покажите конкретный код, а не абстракцию

[конкретный пример кода]
```

**Обязательно:**
- [Обязательное требование 1]
- [Обязательное требование 2]

**Запрещено:**
- [Что нельзя делать в рамках этого паттерна]

---

### Pattern 2: [Следующий паттерн]

[Повторить структуру из Pattern 1]

---

### Pattern 3: [Ещё паттерн]

[Повторить структуру из Pattern 1]

---

## Antipatterns (Запрещено)

Что **категорически запрещено** делать в этом проекте.

### Antipattern 1: [Название]

**Запрещено:** [Что именно запрещено]

**Почему:** [Причина запрета — не просто "плохая практика", а конкретная проблема]

**Вместо этого используй:** [Правильный подход]

**Пример неправильного кода:**

```[язык]
// ❌ ПЛОХО: не делай так
[пример плохого кода]
```

**Пример правильного кода:**

```[язык]
// ✅ ХОРОШО: делай так
[пример правильного кода]
```

---

### Antipattern 2: [Следующий]

[Повторить структуру из Antipattern 1]

---

### Antipattern 3: [Ещё один]

[Повторить структуру из Antipattern 1]

---

## Conventions (Соглашения)

### Именование

**Файлы:**
- [Соглашение 1: например, "kebab-case для файлов компонентов: user-profile.tsx"]
- [Соглашение 2: например, "суффикс .test для тестов: user-profile.test.tsx"]

**Переменные и функции:**
- [Соглашение 1: например, "camelCase для переменных и функций"]
- [Соглашение 2: например, "PascalCase для компонентов и классов"]

**Константы:**
- [Соглашение: например, "UPPER_SNAKE_CASE для констант"]

### Структура проекта

```
[Покажите структуру директорий проекта]

project/
├── src/
│   ├── [модуль1]/
│   ├── [модуль2]/
│   └── ...
├── tests/
├── docs/
└── ...
```

**Правила:**
- [Правило 1: например, "один файл = один компонент"]
- [Правило 2: например, "тесты рядом с кодом, а не в отдельной директории"]

### Git Workflow

**Ветки:**
- Формат: `[type]/[short-description]`
- Типы: `feat`, `fix`, `docs`, `refactor`, `test`, `chore`
- Пример: `feat/user-authentication`, `fix/login-bug`

**Commits:**
- Формат: [Conventional Commits](https://www.conventionalcommits.org/)
- Пример: `feat: add user login endpoint`, `fix: resolve token expiration issue`

**Pull Requests:**
- Заголовок: conventional commits формат
- Описание: Summary + Test plan
- Ревью обязательно (или самомерж разрешён?)

---

## Testing Strategy

### Coverage Target

- **Минимум:** [например, 80% для нового кода]
- **Цель:** [например, 90%+ для критичного кода]

### Типы тестов

**Unit tests:**
- [Что тестируем: например, "бизнес-логика, утилиты, чистые функции"]
- [Фреймворк: например, "Go test", "pytest", "Vitest"]
- [Паттерн: например, "table-driven tests для Go", "describe/it для JS"]

**Integration tests:**
- [Что тестируем: например, "взаимодействие с БД, внешние API"]
- [Подход: например, "testcontainers для изоляции"]

**E2E tests (если есть):**
- [Что тестируем: например, "критичные user flows"]
- [Инструмент: например, "Playwright"]

### Test-Driven Development

- [Требование или рекомендация?]
- [Паттерн: например, "пиши тесты до кода", "пиши тесты вместе с кодом"]

---

## Development Workflow

### Перед началом работы

**ОБЯЗАТЕЛЬНО:**
1. Прочитай этот файл (constitution.md)
2. Прочитай спецификацию задачи (если есть)
3. [Дополнительные файлы: например, "docs/decision-log.md"]

### Проверка перед коммитом

**Обязательные проверки:**
- [ ] Код проходит линтер ([название линтера])
- [ ] Все тесты проходят
- [ ] Coverage не ниже минимума
- [ ] Код следует паттернам из этого файла
- [ ] Нет antipatterns

**Команды для проверки:**

```bash
# Линтер
[команда линтера: например, "npm run lint", "go vet ./..."]

# Тесты
[команда тестов: например, "npm test", "go test ./..."]

# Coverage
[команда coverage: например, "npm run test:coverage", "go test -cover ./..."]

# Билд
[команда билда: например, "npm run build", "go build ./..."]
```

### Автономная работа

**Режим работы:** [Автономный / С подтверждениями]

**Для агентов:**
- [Можешь / Не можешь] устанавливать инструменты без вопросов
- [Можешь / Не можешь] создавать файлы без вопросов
- [Можешь / Не можешь] исправлять ошибки без вопросов

**Блокирующие условия (СТОП и исправь):**
- [ ] Тест падает
- [ ] Линтер выдаёт ошибки
- [ ] Coverage ниже минимума
- [ ] Билд падает

**ЗАПРЕЩЕНО:**
- Переходить к следующей задаче при наличии ошибок
- Коммитить код без тестов
- Изменять ADR без согласования
- [Дополнительные запреты]

---

## Documentation

### Где живёт документация

- **README.md:** минималистичный (что это, как запустить, как контрибьютить)
- **AGENTS.md (этот файл):** детальный контекст для агентов
- **docs/:** [дополнительные документы: architecture.md, api.md, deployment.md, ...]

### Когда обновлять документацию

**ОБЯЗАТЕЛЬНО обновляй AGENTS.md, если:**
- Сделал архитектурное решение → добавь ADR
- Обнаружил работающий паттерн → добавь в Patterns
- Обнаружил antipattern → добавь в Antipatterns
- Узнал что-то важное → зафикси в соответствующей секции

**НЕ раздувай AGENTS.md:**
- Не дублируй код (ссылайся на примеры в кодовой базе)
- Не пиши очевидное (агент знает базовые вещи)
- Не пиши то, что проверяется линтером (code style)

---

## Contact & Support

**Maintainer:** [Имя или команда]

**Вопросы:** [Куда обращаться: email, Slack, GitHub Issues]

**Документация проекта:** [Ссылки на дополнительную документацию]

---

## История изменений

Этот файл версионируется в git. Смотри `git log AGENTS.md` для истории изменений.

**Последнее обновление:** [Дата]

**Ключевые изменения:**
- [Дата]: [Что изменилось]
- [Дата]: [Что изменилось]
