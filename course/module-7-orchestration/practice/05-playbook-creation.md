[← Оглавление](../../../README.md)

# Создайте playbook для своего проекта

Playbook — исполняемый markdown-чеклист для агентов. Каждый пункт `- [ ]` — конкретное действие. Агент (или [Auto Run в Maestro](https://docs.runmaestro.ai/autorun-playbooks)) выполняет задачи сверху вниз, отмечая завершённые.

---

### Упражнение: написать playbook (10 мин)

**1. Выберите задачу из вашего проекта:**

Подходящие задачи:
- Новая фича с backend + frontend + tests
- Рефакторинг с несколькими независимыми компонентами
- Миграция на новую версию библиотеки

**2. Заполните шаблон:**

```markdown
# Playbook: [название задачи]

## Цель
[Что делаем и зачем]

## Подзадачи

### 1. [Название]
Worktree: ../myproject-[название], ветка: feat/[название]
- [ ] [действие 1]
- [ ] [действие 2]
- [ ] Запустить тесты, убедиться что всё зелёное

### 2. [Название]
Worktree: ../myproject-[название], ветка: feat/[название]
- [ ] [действие 1]
- [ ] [действие 2]
- [ ] Запустить тесты

## Порядок выполнения
[Задача 1] ──┐
             ├──> [Задача 3]
[Задача 2] ──┘

## Процедура слияния
- [ ] Merge веток в main
- [ ] Разрешить конфликты
- [ ] Запустить полный набор тестов

## Риски
- [Риск 1]: [план разрешения]
```

Каждый `- [ ]` — атомарное действие, которое агент может выполнить и проверить. Не "реализовать фичу", а "создать endpoint GET /api/users, написать тесты, запустить".

**3. Пример заполненного playbook:**

```markdown
# Playbook: Экспорт списка задач в CSV

## Цель
Добавить экспорт задач в CSV через API и UI. Пользователь нажимает "Export" → скачивается tasks.csv.

## Подзадачи

### 1. Backend: API endpoint
Worktree: ../myproject-backend-export, ветка: feat/backend-export-csv
- [ ] Создать GET /api/tasks/export endpoint
- [ ] Реализовать генерацию CSV с полями: id, title, status, created_at
- [ ] Тест: успешный экспорт с данными
- [ ] Тест: экспорт пустого списка
- [ ] Тест: спецсимволы в названиях задач
- [ ] Запустить все тесты

### 2. Frontend: кнопка Export
Worktree: ../myproject-frontend-export, ветка: feat/frontend-export-button
- [ ] Добавить кнопку "Export to CSV" в таблицу задач
- [ ] Реализовать скачивание файла через fetch + blob
- [ ] Добавить loader на время загрузки
- [ ] Обработать ошибку сети
- [ ] Запустить все тесты

### 3. E2E тесты (после задач 1 и 2)
Worktree: ../myproject-e2e-export, ветка: feat/e2e-export-tests
- [ ] Тест: создать задачи → Export → проверить содержимое CSV
- [ ] Тест: экспорт без авторизации → 401
- [ ] Запустить полный набор тестов

## Порядок
Backend ──┐
          ├──> E2E тесты
Frontend ─┘

## Процедура слияния
- [ ] Merge backend → main
- [ ] Merge frontend → main (проверить конфликты в package.json)
- [ ] Merge e2e → main
- [ ] Финальный прогон: pytest && npm test

## Риски
- Конфликт в package.json: объединить вручную, проверить дубликаты
- API контракт: формат CSV (id,title,status,created_at) согласовать заранее
```

**4. Автоматическое исполнение через Maestro Auto Run:**

Если используете Maestro, playbook можно запустить через Auto Run:
1. Положите markdown-файлы в папку проекта
2. Откройте Auto Run tab → выберите папку → Run
3. Каждая задача `- [ ]` выполняется в свежей сессии агента
4. Прогресс отображается в реальном времени, завершённые задачи отмечаются `- [x]`

Можно включить **Reset on Completion** — оригинальный playbook сохраняется как шаблон, каждый прогон создаёт копию в `Runs/`.

**5. Сохраните в репозиторий:**

```bash
git add playbook-*.md
git commit -m "Add playbook for feature"
```

### Проверка

- [ ] Задача декомпозирована на 2-3 подзадачи
- [ ] Каждая подзадача — чеклист атомарных действий с `- [ ]`
- [ ] Для каждой подзадачи указан worktree и ветка
- [ ] Определён порядок (параллельно/последовательно)
- [ ] Описана процедура слияния и риски
- [ ] Playbook сохранён в репозиторий
---

[← Установите Maestro](04-install-maestro.md) | [Оглавление](../../../README.md) | [Чеклист готовности →](06-checklist.md)
