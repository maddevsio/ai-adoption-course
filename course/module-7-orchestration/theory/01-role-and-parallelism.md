[← Оглавление](../../../README.md)

# Модуль 7: Параллельные агенты и оркестрация

## 1. От кодера к архитектору оркестра

На этом уровне сдвигается роль разработчика. Кодинг не исчезает, но перестаёт быть основной деятельностью.

**Три компетенции:**

1. **Проектирование** — писать спецификации, которые агенты могут автономно исполнить. Вы описываете, каким должен быть код, а не пишете его сами.

2. **Менеджмент оркестратора** — настраивать роли агентов, выбирать модели под задачи. Умная модель планирует, дешёвая кодит. Управлять стратегиями: когда перезапускать, когда менять агентов.

3. **Контроль качества** — приёмка результатов, code review PR-ов от агентов. Мониторинг метрик: время выполнения, количество итераций, расход токенов.

Кодинг остаётся там, где агенты не справляются:
- **Сложная бизнес-логика** без чёткой спецификации
- **Интеграции** с недокументированными API
- **Архитектурные решения** и отладка нетривиальных багов

Но объём ручного кодинга снижается.

## 2. Зачем нужна параллельность

Один агент = одна задача (Йегге ур. 5) 

Агент делает задачу за задачей последовательно. Но он неавтономен — нуждается в постановке задачи, направлении, фидбэке.

Несколько агентов = несколько задач одновременно. (Йегге ур. 6-7) 

Один агент работает над фронтендом, другой — над бэкендом, третий пишет тесты. Те же задачи выполняются быстрее. Но агенты всё ещё зависят от человека, который ведёт их к цели.

> [Диаграмма: Параллельная работа в двух терминалах](../diagrams/terminal-split.md)

**Когда параллельность оправдана:**
- Фича состоит из 5+ независимых подзадач
- Задачи не блокируют друг друга
- Есть бюджет на несколько параллельных сессий

**Когда параллельность избыточна:**
- Маленькая задача (один баг, один endpoint)
- Задачи сильно связаны (нужен результат первой для начала второй)
- Первый раз делаете что-то новое — сначала проверьте на одном агенте

**Честно про overhead:** параллельность добавляет сложность. Нужно изолировать контексты, разрешать конфликты при слиянии, мониторить несколько процессов. Ценность проявляется в масштабе — когда нужно сделать 10 фич, а не одну.

**Следующий уровень (Йегге ур. 8):**
Оркестратор — иерархическая система из агентов. Она принимает задачи, выполняет их, дотаскивает до конца, тестирует и ревьюит. Разработчик нужен для обслуживания, отладки и указания стратегии.

```
                    ┌──────────────┐
                    │  Разработчик │
                    │  (человек)   │
                    └──────┬───────┘
                           │ задачи + стратегия
                    ┌──────▼───────┐
                    │ Оркестратор  │
                    │ (Opus/GPT-5) │
                    └──────┬───────┘
              ┌────────────┼────────────┐
              │            │            │
       ┌──────▼──────┐ ┌──▼───────┐ ┌──▼──────────┐
       │ Планировщик │ │Ресёрчер  │ │ QA/Ревьюер  │
       │  (Sonnet)   │ │(Sonnet)  │ │  (Sonnet)   │
       └──────┬──────┘ └──────────┘ └─────────────┘
              │ подзадачи
    ┌─────────┼─────────┐
    │         │         │
┌───▼───┐ ┌──▼────┐ ┌──▼────┐
│Dev #1 │ │Dev #2 │ │Dev #3 │
│(Haiku)│ │(Haiku)│ │(Haiku)│
└───────┘ └───────┘ └───────┘
```

**Плюсы оркестратора:**
- **Масштаб:** 10+ задач параллельно, человек только контролирует
- **Специализация:** каждый агент оптимизирован под свою роль и стоимость
- **Автономность:** цепочка Research -> Plan -> Implement -> Review работает без ручного вмешательства
- **Воспроизводимость:** playbook можно переиспользовать на аналогичных задачах

**Минусы и сложности:**
- **Инфраструктура:** нужно настроить credential management, мониторинг, систему очередей
- **Стоимость координации:** оркестратор тратит токены на планирование и проверку. Это overhead поверх полезной работы
- **Отладка:** в цепочке из 5 агентов найти причину сбоя сложнее, чем в одном
- **Нестабильность:** агенты могут галлюцинировать, зацикливаться, конфликтовать. Нужны механизмы перезапуска и fallback
- **Порог входа:** время на создание playbook-ов, настройку ролей, калибровку промптов
---

[← Чеклист выполнения](../../module-6-mcp/practice/02-checklist.md) | [Оглавление](../../../README.md) | [3. Изоляция контекстов с git worktree →](02-isolation-and-loops.md)
