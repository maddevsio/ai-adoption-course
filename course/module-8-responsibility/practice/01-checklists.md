# Чеклисты для работы с AI-кодом

## Чеклист "Доверяй, но проверяй"

Перед каждым коммитом кода от ИИ пройдитесь по чеклисту:

#### Уровень 3
- [ ] **В промпте и контексте нет чувствительных данных?**
- [ ] **Перед ревью читаю сгенерированный код?** Если есть непонятные места — разберитесь.
- [ ] **Запустил тесты и они прошли?** `npm test` / `pytest` / `go test` — зелёные.
- [ ] **Нет захардкоженных секретов?** Поиск по коду: `grep -r "API_KEY\|password\|secret" .`
- [ ] **Нет лишних зависимостей?** Проверьте `package.json` / `requirements.txt` / `go.mod` — всё необходимо?
- [ ] **Соответствует конвенциям проекта?** Именование, форматирование, структура.
- [ ] **Diff перед слиянием просмотрен?** — нет ли неожиданных изменений?
- [ ] **Co-authorship указан?** (Для прозрачности) Добавьте в коммит: `Co-Authored-By: Claude <noreply@anthropic.com>`.

#### Уровень 4
- [ ] **Проверил MCP-доступы?** Какие серверы использовались? Правильные ли права?
- [ ] **Read-only где возможно?** MCP-серверы для ревью, анализа, аудита — только чтение. БД — только SELECT.
- [ ] **Сетевой доступ ограничен?** MCP-серверы не имеют доступа в интернет без явной необходимости.
- [ ] **Нет доступа к чувствительным путям?** `~/.ssh`, `~/.aws`, `~/.config`, `.env` — исключены из конфигурации MCP filesystem.
- [ ] **Действия агента логируются?** Trace-файлы или логи фиксируют, какие команды выполнены и какие файлы изменены.

#### Уровень 5
- [ ] **Агенты изолированы?** Параллельные агенты работают в отдельных `git worktree`, нет конфликтов.
- [ ] **Sandboxing настроен?** Агенты работают в Docker-контейнерах с минимальными правами.
- [ ] **Результаты согласованы?** Код, документация и тесты от разных агентов не противоречат друг другу.
- [ ] **Trace-файл заполнен?** Каждый агент зафиксировал процесс: команды, решения, изменения.
- [ ] **ADR не нарушены?** Агенты не изменили архитектурные решения (tech stack, паттерны, принципы безопасности) без согласования.



### Что делать если была допущена ошибка ИБ

1. **Не паникуйте, но действуйте быстро**
2. **Остановите деплой** если код уже в production
3. **Исправьте уязвимость** — попросите агента переписать код безопасно
4. **Ротируйте credentials** если они были скомпрометированы
5. **Проверьте Git историю** — если credentials были закоммичены, удалите их из истории (git filter-branch или BFG Repo-Cleaner)
6. **Обновите AGENTS.md** — добавьте правило для предотвращения подобных проблем в будущем
